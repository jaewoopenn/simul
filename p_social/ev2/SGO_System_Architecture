// Sustainable Grid Orchestration System Architecture
digraph SGO_Architecture {
	compound=true dpi=300 fontname=Helvetica rankdir=LR size="12,8"
	node [fontname=Helvetica fontsize=12 shape=box style="filled, rounded"]
	edge [fontname=Helvetica fontsize=10]
	subgraph cluster_0 {
		color=gray40 fontcolor=gray40 label="External Environment (Dynamic Constraints)" style=dashed
		Grid [label="Grid Operator / EMS
(Renewable Supply & TOU Price)" color="#1565C0" fillcolor="#E3F2FD"]
		User [label="EV Users
(Arrival, SoC, Deadline)" color="#EF6C00" fillcolor="#FFF3E0"]
	}
	subgraph cluster_1 {
		color="#2E7D32" fontcolor="#2E7D32" fontsize=14 label="Sustainable Grid Orchestration (SGO) Controller" penwidth=2 style=solid
		bgcolor="#F1F8E9"
		State [label="State Estimation
(Monitor Current Loads)" color="#558B2F" fillcolor=white shape=ellipse]
		Gatekeeper [label="<<Layer 1>>
Sustainability Gatekeeper
(Capacity-Aware Admission Control)" color="#2E7D32" fillcolor="#C8E6C9" penwidth=2 shape=component]
		Scheduler [label="<<Layer 2>>
Resource-Efficient Scheduler
(Least Laxity First Policy)" color="#558B2F" fillcolor="#DCEDC8" shape=component]
		State -> Gatekeeper [style=dotted]
	}
	subgraph cluster_2 {
		color=gray40 fontcolor=gray40 label="Physical Infrastructure" style=dashed
		EVSE [label="Smart EVSEs
(Power Delivery)" color=black fillcolor="#EEEEEE"]
		Battery [label="EV Batteries
(State of Charge)" fillcolor="#E0E0E0" shape=cylinder]
	}
	Grid -> Gatekeeper [label=" Dynamic Capacity Limit P_limit(t)
(Based on TOU/Renewables)" color="#1565C0" penwidth=1.5]
	User -> Gatekeeper [label=" Charging Request
(Energy Demand)" color="#EF6C00" penwidth=1.5]
	Gatekeeper -> Scheduler [label=" Admitted Set
(Feasible Requests)" color="#2E7D32" penwidth=2]
	Gatekeeper -> User [label=" Rejection Signal
(Infeasible)" color="#D32F2F" constraint=false style=dotted]
	Scheduler -> EVSE [label=" Optimal Charging Profile
(Setpoint)" color="#2E7D32" penwidth=1.5]
	EVSE -> Battery [label=" Energy Transfer" color=black]
	Battery -> State [label=" Real-time SOC
Feedback" color=gray50 style=dashed]
	EVSE -> State [color=gray50 style=dashed]
}
